<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="'ë©´ì ‘ ì§„í–‰ - ' + ${sessionTitle}">ë©´ì ‘ ì§„í–‰</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/common.css}" rel="stylesheet">
    <link th:href="@{/css/session.css}" rel="stylesheet">
    <link th:href="@{/css/agora-media.css}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.19.0.js"></script>
    <style>
        :root {
            --primary-color: #667eea;
            --host-color: #667eea;
            --student-color: #4CAF50;
            --reviewer-color: #FF9800;
        }
        
        body {
            background: white !important;
        }
        
        body.role-host {
            --role-color: var(--host-color);
        }
        body.role-student {
            --role-color: var(--student-color);
        }
        body.role-reviewer {
            --role-color: var(--reviewer-color);
        }
        
        .navbar {
            background: white;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .navbar-brand {
            color: var(--role-color);
        }
        
        .user-role {
            background: var(--role-color);
            color: white;
        }
        
        .session-info-bar {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 1.5rem 0;
        }
        
        .video-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .video-container {
            background: #000;
            border-radius: 8px;
            aspect-ratio: 16/9;
            width: 100%;
            max-width: 640px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .container {
            background: white;
        }
        
        .card {
            background: white;
            border: 1px solid #e0e0e0;
        }
        
        .card-header {
            background: white;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .current-question {
            border: 2px solid var(--role-color);
        }
        
        .current-question .card-header {
            background: white;
            color: var(--role-color);
            border-bottom: 2px solid var(--role-color);
        }
        
        .question-display {
            background: white;
            padding: 2rem;
        }
        
        #current-question-text {
            font-size: 1.25rem;
            line-height: 1.6;
            color: #333;
            margin: 0;
        }
        
        .answer-card {
            border: 2px solid var(--role-color);
        }
        
        .answer-card .card-header {
            background: white;
            color: var(--role-color);
            border-bottom: 2px solid var(--role-color);
        }
        
        .btn-primary {
            background: var(--role-color);
            border-color: var(--role-color);
        }
        
        .btn-primary:hover {
            background: var(--role-color);
            opacity: 0.9;
        }
        
        .btn-success {
            background: var(--role-color);
            border-color: var(--role-color);
        }
        
        .btn-success:hover {
            background: var(--role-color);
            opacity: 0.9;
        }
        
        .badge-live {
            background: var(--role-color);
            color: white;
        }
        
        .interview-layout {
            background: white;
        }
        
        .student-view, .host-view {
            background: white;
        }
        
        .media-section {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .video-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .video-container {
            background: #f5f5f5;
            border-radius: 8px;
            aspect-ratio: 16/9;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .video-placeholder {
            color: #999;
            font-size: 1.2rem;
        }
        
        .remote-videos-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .media-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            background: white;
        }
        
        .media-btn {
            padding: 0.75rem 1.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        
        .media-btn:hover {
            background: #f5f5f5;
        }
        
        .media-btn.audio.muted {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .media-btn.video.off {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .media-btn.leave {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .media-btn.leave:hover {
            background: #dc2626;
        }
        
        .session-controls {
            margin-bottom: 1.5rem;
        }
        
        .control-buttons {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .control-buttons .btn {
            flex: 1;
            padding: 0.75rem 1rem;
            font-weight: 600;
            border-radius: 6px;
        }
        
        .session-status-display {
            text-align: center;
            padding: 0.75rem;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 0.5rem 1.25rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .status-badge.waiting {
            background: #e9ecef;
            color: #6c757d;
        }
        
        .status-badge.ongoing {
            background: #d1f4e0;
            color: #28a745;
        }
        
        .status-badge.paused {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-badge.ended {
            background: #f8d7da;
            color: #721c24;
        }

        .answer-review-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: white;
        }

        .answer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #f0f0f0;
        }

        .user-name-badge {
            font-weight: 600;
            color: #333;
            background: #f8f9fa;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.9rem;
        }

        .answer-time {
            color: #666;
            font-size: 0.85rem;
        }

        .question-text, .answer-text {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 6px;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .question-text {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }

        .answer-text {
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            color: #495057;
        }

        .ai-feedback-section {
            margin: 1rem 0;
            padding: 1rem;
            background: #e3f2fd;
            border-radius: 6px;
            border-left: 4px solid #2196f3;
        }

        .ai-feedback-loading {
            color: #1976d2;
            font-weight: 500;
            text-align: center;
            padding: 0.5rem;
        }

        .ai-feedback-content {
            color: #1565c0;
        }

        .ai-feedback-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #0d47a1;
        }

        .ai-score {
            background: #bbdefb;
            color: #0d47a1;
            padding: 0.5rem;
            border-radius: 4px;
            margin-bottom: 0.75rem;
            font-weight: 600;
            text-align: center;
        }

        .ai-strengths, .ai-improvements {
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .interviewer-evaluation {
            border-top: 1px solid #e0e0e0;
            padding-top: 1rem;
            margin-top: 1rem;
        }

        .evaluation-header {
            margin-bottom: 1rem;
        }

        .evaluation-header h5 {
            color: #495057;
            font-size: 1rem;
            font-weight: 600;
            margin: 0;
        }

        .score-input-group, .feedback-input-group {
            margin-bottom: 1rem;
        }

        .score-input-group label, .feedback-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #495057;
            font-size: 0.9rem;
        }

        .score-input {
            width: 100px;
            padding: 0.5rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .feedback-textarea {
            width: 100%;
            min-height: 80px;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            resize: vertical;
            font-size: 0.9rem;
            font-family: inherit;
        }

        .score-input:focus, .feedback-textarea:focus {
            border-color: var(--role-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        .evaluation-submit-btn {
            background: var(--role-color);
            color: white;
            border: none;
            padding: 0.5rem 1.25rem;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .evaluation-submit-btn:hover {
            opacity: 0.9;
        }

        .evaluation-submit-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .submitted-evaluation {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 0.75rem;
            margin-top: 0.5rem;
            color: #155724;
            font-size: 0.9rem;
        }

        .answers-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }

        .scrollable {
            max-height: 400px;
            overflow-y: auto;
        }

        .countdown-timer {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            margin-left: 1rem;
        }

        .countdown-timer.warning {
            color: #ff9800;
            animation: pulse 1s infinite;
        }

        .countdown-timer.danger {
            color: #ef4444;
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .expiration-warning {
            background: #fff3cd;
            border: 2px solid #ff9800;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: 600;
            color: #856404;
        }

        .btn-end-session {
            background: #ef4444;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-end-session:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
        }
    </style>
</head>
<body th:classappend="${isHost} ? 'role-host' : 'role-student'">
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <a class="navbar-brand" href="/session/list">Mockerview</a>
                <div class="navbar-nav">
                    <a class="nav-link" th:href="@{/session/list}">ì„¸ì…˜ ëª©ë¡</a>
                    <div class="user-info">
                        <span class="user-name" th:text="${userName}">ì‚¬ìš©ì</span>
                        <span class="user-role" th:text="${isHost} ? 'ë©´ì ‘ê´€' : 'ì§€ì›ì'">ì—­í• </span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="session-info-bar">
        <div class="container">
            <div class="session-title-section">
                <h1 th:text="${sessionTitle}">ë©´ì ‘ ì„¸ì…˜</h1>
                <div class="session-meta">
                    <span class="timer">
                        <span id="session-timer">00:00</span>
                    </span>
                    <span id="countdown-display" class="countdown-timer"></span>
                    <span class="badge badge-live">ì§„í–‰ ì¤‘</span>
                    <span id="session-stats">ì§ˆë¬¸ 0ê°œ â€¢ ë‹µë³€ 0ê°œ</span>
                </div>
            </div>
            <div class="session-actions">
                <button th:if="${isHost}" id="endSessionBtn" class="btn-end-session" onclick="endSessionManually()">
                    ğŸ›‘ ì„¸ì…˜ ì¢…ë£Œ
                </button>
                <a th:href="@{/session/scoreboard/{id}(id=${sessionId})}" class="btn btn-secondary btn-sm">
                    ì ìˆ˜íŒ
                </a>
                <a th:href="@{/session/detail/{id}(id=${sessionId})}" class="btn btn-primary btn-sm">
                    ìƒì„¸ ê²°ê³¼
                </a>
            </div>
        </div>
    </div>

    <div id="expiration-warning" class="container" style="display: none;">
        <div class="expiration-warning">
            âš ï¸ ì„¸ì…˜ì´ 5ë¶„ í›„ ìë™ ì¢…ë£Œë©ë‹ˆë‹¤!
        </div>
    </div>

    <div class="container">
        <div class="media-section mb-4" id="mediaSection" 
                th:style="${sessionType == 'AUDIO' or sessionType == 'VIDEO'} ? 'display: block;' : 'display: none;'">
            <div class="video-grid" id="videoGrid">
                <div id="local-video" class="video-container">
                    <div class="video-placeholder">
                        <span th:text="${sessionType == 'VIDEO' ? 'ğŸ“¹ ë‚´ í™”ë©´' : 'ğŸ¤ ìŒì„± ì—°ê²° ì¤‘...'}">ë¯¸ë””ì–´</span>
                    </div>
                </div>
                <div id="remote-videos" class="remote-videos-container"></div>
            </div>
            <div class="media-controls" id="mediaControls">
                <button id="audioBtn" class="media-btn audio" onclick="toggleAudio()">ğŸ¤</button>
                <button id="videoBtn" class="media-btn video" onclick="toggleVideo()" 
                        th:style="${sessionType == 'VIDEO'} ? 'display: inline-block;' : 'display: none;'">ğŸ“¹</button>
                <button class="media-btn leave" onclick="stopMedia()">ğŸ“ ì¢…ë£Œ</button>
            </div>
        </div>

        <div class="interview-layout">
            <div th:if="${isHost}" class="host-view">
                <div class="card session-controls">
                    <div class="card-header">
                        <h4>ë©´ì ‘ ì œì–´</h4>
                    </div>
                    <div class="card-body">
                        <div class="control-buttons">
                            <button id="startInterviewBtn" onclick="startInterview()" class="btn btn-success">
                                ë©´ì ‘ ì‹œì‘
                            </button>
                            <button id="pauseInterviewBtn" onclick="pauseInterview()" class="btn btn-warning" style="display: none;">
                                ì¼ì‹œì •ì§€
                            </button>
                            <button id="endInterviewBtn" onclick="endInterview()" class="btn btn-danger" style="display: none;">
                                ë©´ì ‘ ì¢…ë£Œ
                            </button>
                        </div>
                        <div class="session-status-display">
                            <span class="status-badge waiting" id="sessionStatusBadge">ëŒ€ê¸°ì¤‘</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h4>ì§ˆë¬¸ ì¶œì œ</h4>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">ì§ˆë¬¸ ë‚´ìš©</label>
                            <textarea id="newQuestionText" placeholder="ë©´ì ‘ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ìˆœì„œ</label>
                                <input type="number" id="newQuestionOrder" value="1" min="1" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ë‹µë³€ì‹œê°„</label>
                                <select id="newTimerOrder" class="form-select">
                                    <option value="30">30ì´ˆ</option>
                                    <option value="60" selected>1ë¶„</option>
                                    <option value="90">1ë¶„ 30ì´ˆ</option>
                                    <option value="120">2ë¶„</option>
                                    <option value="180">3ë¶„</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="sendQuestion()" class="btn btn-primary btn-full">ì§ˆë¬¸ ì¶œì œ</button>
                    </div>
                </div>

                <div class="card mt-4">
                    <div class="card-header">
                        <h4>ì œì¶œëœ ë‹µë³€ ë° í‰ê°€</h4>
                        <span id="answer-count" class="badge badge-waiting">0ê°œ</span>
                    </div>
                    <div class="card-body">
                        <div id="answers-list" class="answers-list">
                            <div class="empty-state">
                                <p>ì•„ì§ ì œì¶œëœ ë‹µë³€ì´ ì—†ìŠµë‹ˆë‹¤</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div th:unless="${isHost}" class="student-view">
                <div class="card current-question">
                    <div class="card-header">
                        <h3>í˜„ì¬ ì§ˆë¬¸</h3>
                        <div class="question-info">
                            <span id="question-number">Q1</span>
                            <span id="question-timer">â±ï¸ 00:00</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="current-question" class="question-display">
                            <p id="current-question-text">ë©´ì ‘ê´€ì´ ì§ˆë¬¸ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤...</p>
                        </div>
                        <input type="hidden" id="currentQuestionId" value="">
                    </div>
                </div>

                <div class="card answer-card mt-4" id="answer-section">
                    <div class="card-header">
                        <h4>ë‹µë³€ ì‘ì„±</h4>
                        <span class="answer-tip">ì°¨ë¶„íˆ ìƒê°í•˜ê³  ë‹µë³€í•´ë³´ì„¸ìš”</span>
                    </div>
                    <div class="card-body">
                        <div class="answer-mode-toggle" style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <button id="textModeBtn" class="btn btn-secondary active" onclick="switchAnswerMode('text')">
                                ğŸ’¬ í…ìŠ¤íŠ¸
                            </button>
                            <button id="voiceModeBtn" class="btn btn-secondary" onclick="switchAnswerMode('voice')" 
                                    th:if="${sessionType == 'AUDIO' or sessionType == 'VIDEO'}">
                                ğŸ¤ ìŒì„±
                            </button>
                        </div>
                
                        <div id="text-answer-area">
                            <div class="form-group">
                                <textarea id="answerText" placeholder="ì—¬ê¸°ì— ë‹µë³€ì„ ì‘ì„±í•˜ì„¸ìš”..." class="form-control" rows="5"></textarea>
                                <div class="char-counter">
                                    <span id="charCount">0</span>/1000ì
                                </div>
                            </div>
                            <button onclick="submitAnswer()" class="btn btn-success btn-full">ë‹µë³€ ì œì¶œ</button>
                        </div>
                
                        <div id="voice-answer-area" style="display: none;">
                            <div th:if="${sessionType == 'VIDEO'}" class="video-recording-section" style="text-align: center; padding: 1rem;">
                                <video id="recordingPreview" width="300" height="200" style="border: 1px solid #ccc; border-radius: 6px; margin-bottom: 1rem;" muted></video>
                                <br>
                                <button id="videoRecordBtn" class="btn btn-danger btn-lg" onclick="toggleVideoRecording()" 
                                        style="width: 120px; height: 50px; border-radius: 8px; margin-bottom: 1rem;">
                                    ğŸ¥ ë…¹í™” ì‹œì‘
                                </button>
                                <div id="videoRecordingStatus" style="margin-top: 0.5rem; color: #6c757d; font-weight: 500;">
                                    ë¹„ë””ì˜¤ ë‹µë³€ ë…¹í™” ì¤€ë¹„
                                </div>
                            </div>
                            
                            <div th:unless="${sessionType == 'VIDEO'}" class="audio-recorder-container" style="text-align: center; padding: 2rem;">
                                <button id="recordBtn" class="btn btn-danger btn-lg" onclick="toggleRecording()" 
                                        style="width: 100px; height: 100px; border-radius: 50%; font-size: 2rem;">
                                    ğŸ¤
                                </button>
                                <div id="recordingStatus" style="margin-top: 1rem; color: #6c757d; font-weight: 500;">
                                    ë…¹ìŒ ì‹œì‘í•˜ë ¤ë©´ í´ë¦­
                                </div>
                            </div>
                            
                            <button id="submitVoiceBtn" onclick="submitVoiceAnswer()" class="btn btn-success btn-lg" 
                                    style="margin-top: 1rem; display: none;">
                                ë‹µë³€ ì œì¶œ
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card mt-4">
                    <div class="card-header">
                        <h4>AI í”¼ë“œë°±</h4>
                        <span class="ai-status">ëŒ€ê¸°ì¤‘</span>
                    </div>
                    <div class="card-body">
                        <div id="ai-feedback-list" class="feedback-list scrollable">
                            <div class="empty-state">
                                <div class="ai-icon">ğŸ¤–</div>
                                <p>ë‹µë³€ì´ ì œì¶œë˜ë©´ AIê°€ ì¦‰ì‹œ ë¶„ì„í•©ë‹ˆë‹¤</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        const SESSION_DATA = {
            sessionId: /*[[${sessionId}]]*/ 1,
            userId: /*[[${userId}]]*/ 1,
            userName: /*[[${userName}]]*/ 'ì‚¬ìš©ì',
            isHost: /*[[${isHost}]]*/ false,
            sessionType: /*[[${sessionType}]]*/ 'TEXT',
            expiresAt: /*[[${session.expiresAt}]]*/ null
        };
        
        let countdownInterval = null;
        let warningShown = false;
        
        function startCountdown() {
            if (!SESSION_DATA.expiresAt) return;
            
            const expiresAt = new Date(SESSION_DATA.expiresAt).getTime();
            
            countdownInterval = setInterval(() => {
                const now = new Date().getTime();
                const remaining = expiresAt - now;
                
                if (remaining <= 0) {
                    clearInterval(countdownInterval);
                    document.getElementById('countdown-display').textContent = 'ë§Œë£Œë¨';
                    document.getElementById('countdown-display').className = 'countdown-timer danger';
                    return;
                }
                
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                
                document.getElementById('countdown-display').textContent = 
                    `ë‚¨ì€ ì‹œê°„: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (remaining <= 5 * 60 * 1000) {
                    document.getElementById('countdown-display').className = 'countdown-timer warning';
                    if (!warningShown) {
                        document.getElementById('expiration-warning').style.display = 'block';
                        warningShown = true;
                    }
                }
                
                if (remaining <= 1 * 60 * 1000) {
                    document.getElementById('countdown-display').className = 'countdown-timer danger';
                }
            }, 1000);
        }
        
        async function endSessionManually() {
            if (!confirm('ì •ë§ë¡œ ì„¸ì…˜ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            try {
                const token = getToken();
                const response = await fetch(`/api/session/${SESSION_DATA.sessionId}/end`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': token
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert('ì„¸ì…˜ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤');
                    window.location.href = '/session/list';
                } else {
                    alert(data.message || 'ì„¸ì…˜ ì¢…ë£Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
                }
            } catch (error) {
                console.error('ì„¸ì…˜ ì¢…ë£Œ ì˜¤ë¥˜:', error);
                alert('ì„¸ì…˜ ì¢…ë£Œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');
            }
        }
        
        console.log('=== ì„¸ì…˜ ë°ì´í„° ë””ë²„ê¹… ===');
        console.log('sessionType:', SESSION_DATA.sessionType);
        
        const answerTextArea = document.getElementById('answerText');
        if (answerTextArea) {
            answerTextArea.addEventListener('input', function() {
                const count = this.value.length;
                document.getElementById('charCount').textContent = count;
                if (count > 1000) {
                    this.value = this.value.substring(0, 1000);
                    document.getElementById('charCount').textContent = 1000;
                }
            });
        }
        
        let agoraClient = null;
        let mediaEnabled = false;
        let interviewStatus = 'waiting';
        let currentAnswerMode = 'text';
        let audioRecorder = null;
        let audioBlob = null;
        let audioChunks = [];
        let answerCount = 0;
        let videoRecordingStream = null;
        let videoRecorder = null;
        let recordedVideoBlob = null;
    
        function getToken() {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                const [name, value] = cookie.trim().split('=');
                if (name === 'Authorization') {
                    return value;
                }
            }
            return '';
        }
    
        async function initializeMedia() {
            try {
                const token = getToken();
                const response = await fetch(`/api/agora/token/${SESSION_DATA.sessionId}`, {
                    method: 'POST',
                    headers: { 'Authorization': token }
                });
                
                const tokenData = await response.json();
                
                agoraClient = new AgoraClient(tokenData.appId);
                await agoraClient.join(tokenData.channel, tokenData.token, tokenData.uid);
                
                if (SESSION_DATA.sessionType === 'VIDEO') {
                    await agoraClient.publishAudioVideo();
                    document.getElementById('videoBtn').style.display = 'inline-block';
                } else {
                    await agoraClient.publishAudioOnly();
                }
                
                document.getElementById('mediaSection').style.display = 'block';
                mediaEnabled = true;
                
            } catch (error) {
                console.error('ë¯¸ë””ì–´ ì‹œì‘ ì‹¤íŒ¨:', error);
            }
        }
    
        async function stopMedia() {
            if (agoraClient) {
                await agoraClient.leave();
                agoraClient = null;
            }
            mediaEnabled = false;
            document.getElementById('mediaSection').style.display = 'none';
        }
    
        function toggleAudio() {
            if (agoraClient) {
                const enabled = agoraClient.toggleAudio();
                const btn = document.getElementById('audioBtn');
                btn.classList.toggle('muted', !enabled);
                btn.innerHTML = enabled ? 'ğŸ¤' : 'ğŸ”‡';
            }
        }
    
        function toggleVideo() {
            if (agoraClient && SESSION_DATA.sessionType === 'VIDEO') {
                const enabled = agoraClient.toggleVideo();
                const btn = document.getElementById('videoBtn');
                btn.classList.toggle('off', !enabled);
                btn.innerHTML = enabled ? 'ğŸ“¹' : 'ğŸš«';
            }
        }
    
        function startInterview() {
            if (confirm('ë©´ì ‘ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                interviewStatus = 'ongoing';
                document.getElementById('startInterviewBtn').style.display = 'none';
                document.getElementById('pauseInterviewBtn').style.display = 'inline-block';
                document.getElementById('endInterviewBtn').style.display = 'inline-block';
                
                const badge = document.getElementById('sessionStatusBadge');
                badge.textContent = 'ì§„í–‰ì¤‘';
                badge.className = 'status-badge ongoing';
                
                if (typeof stompClient !== 'undefined' && stompClient.connected) {
                    stompClient.send(`/app/session/${SESSION_DATA.sessionId}/control`, {}, JSON.stringify({
                        action: 'START',
                        timestamp: new Date().toISOString()
                    }));
                }
                
                console.log('ë©´ì ‘ ì‹œì‘ë¨');
            }
        }
    
        function pauseInterview() {
            if (confirm('ë©´ì ‘ì„ ì¼ì‹œì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                interviewStatus = 'paused';
                document.getElementById('pauseInterviewBtn').textContent = 'ì¬ê°œ';
                document.getElementById('pauseInterviewBtn').onclick = resumeInterview;
                
                const badge = document.getElementById('sessionStatusBadge');
                badge.textContent = 'ì¼ì‹œì •ì§€';
                badge.className = 'status-badge paused';
                
                if (typeof stompClient !== 'undefined' && stompClient.connected) {
                    stompClient.send(`/app/session/${SESSION_DATA.sessionId}/control`, {}, JSON.stringify({
                        action: 'PAUSE'
                    }));
                }
            }
        }
    
        function resumeInterview() {
            interviewStatus = 'ongoing';
            document.getElementById('pauseInterviewBtn').textContent = 'ì¼ì‹œì •ì§€';
            document.getElementById('pauseInterviewBtn').onclick = pauseInterview;
            
            const badge = document.getElementById('sessionStatusBadge');
            badge.textContent = 'ì§„í–‰ì¤‘';
            badge.className = 'status-badge ongoing';
            
            if (typeof stompClient !== 'undefined' && stompClient.connected) {
                stompClient.send(`/app/session/${SESSION_DATA.sessionId}/control`, {}, JSON.stringify({
                    action: 'RESUME'
                }));
            }
        }
    
        function endInterview() {
            if (confirm('ë©´ì ‘ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì¢…ë£Œ í›„ì—ëŠ” ë‹µë³€ì„ ì œì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                interviewStatus = 'ended';
                document.getElementById('pauseInterviewBtn').style.display = 'none';
                document.getElementById('endInterviewBtn').style.display = 'none';
                
                const badge = document.getElementById('sessionStatusBadge');
                badge.textContent = 'ì¢…ë£Œë¨';
                badge.className = 'status-badge ended';
                
                if (typeof stompClient !== 'undefined' && stompClient.connected) {
                    stompClient.send(`/app/session/${SESSION_DATA.sessionId}/control`, {}, JSON.stringify({
                        action: 'END'
                    }));
                }
                
                alert('ë©´ì ‘ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                
                setTimeout(() => {
                    window.location.href = `/session/detail/${SESSION_DATA.sessionId}`;
                }, 2000);
            }
        }
    
        function switchAnswerMode(mode) {
            currentAnswerMode = mode;
            
            if (mode === 'text') {
                document.getElementById('textModeBtn').classList.add('active');
                const voiceBtn = document.getElementById('voiceModeBtn');
                if (voiceBtn) voiceBtn.classList.remove('active');
                document.getElementById('text-answer-area').style.display = 'block';
                document.getElementById('voice-answer-area').style.display = 'none';
            } else {
                const textBtn = document.getElementById('textModeBtn');
                if (textBtn) textBtn.classList.remove('active');
                document.getElementById('voiceModeBtn').classList.add('active');
                document.getElementById('text-answer-area').style.display = 'none';
                document.getElementById('voice-answer-area').style.display = 'block';
            }
        }

        async function toggleVideoRecording() {
            const recordBtn = document.getElementById('videoRecordBtn');
            const recordingStatus = document.getElementById('videoRecordingStatus');
            const submitBtn = document.getElementById('submitVoiceBtn');

            if (!videoRecorder || videoRecorder.state === 'inactive') {
                try {
                    videoRecordingStream = await navigator.mediaDevices.getUserMedia({ 
                        video: true, 
                        audio: true 
                    });
                    
                    document.getElementById('recordingPreview').srcObject = videoRecordingStream;
                    document.getElementById('recordingPreview').play();
                    
                    videoRecorder = new MediaRecorder(videoRecordingStream);
                    let videoChunks = [];
                    
                    videoRecorder.ondataavailable = (e) => {
                        if (e.data.size > 0) {
                            videoChunks.push(e.data);
                        }
                    };
                    
                    videoRecorder.onstop = () => {
                        recordedVideoBlob = new Blob(videoChunks, { type: 'video/webm' });
                        recordingStatus.textContent = 'ë…¹í™” ì™„ë£Œ! ì œì¶œí•˜ë ¤ë©´ ë‹µë³€ ì œì¶œ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”';
                        submitBtn.style.display = 'inline-block';
                        videoRecordingStream.getTracks().forEach(track => track.stop());
                    };
                    
                    videoRecorder.start();
                    recordBtn.innerHTML = 'â¹ï¸ ë…¹í™” ì¤‘ì§€';
                    recordBtn.style.background = '#dc3545';
                    recordingStatus.textContent = 'ë¹„ë””ì˜¤ ë…¹í™” ì¤‘... ì¤‘ì§€í•˜ë ¤ë©´ ë‹¤ì‹œ í´ë¦­';
                    submitBtn.style.display = 'none';
                    
                } catch (error) {
                    alert('ì¹´ë©”ë¼/ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');
                    console.error('ë¹„ë””ì˜¤ ë…¹í™” ì‹œì‘ ì‹¤íŒ¨:', error);
                }
            } else if (videoRecorder.state === 'recording') {
                videoRecorder.stop();
                recordBtn.innerHTML = 'ğŸ¥ ë…¹í™” ì‹œì‘';
                recordBtn.style.background = '';
            }
        }
    
        async function toggleRecording() {
            const recordBtn = document.getElementById('recordBtn');
            const recordingStatus = document.getElementById('recordingStatus');
            const submitVoiceBtn = document.getElementById('submitVoiceBtn');
            
            if (!audioRecorder || audioRecorder.state === 'inactive') {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    audioRecorder = new MediaRecorder(stream);
                    audioChunks = [];
                    
                    audioRecorder.ondataavailable = (e) => {
                        if (e.data.size > 0) {
                            audioChunks.push(e.data);
                        }
                    };
                    
                    audioRecorder.onstop = () => {
                        audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                        recordingStatus.textContent = 'ë…¹ìŒ ì™„ë£Œ! ì œì¶œí•˜ë ¤ë©´ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”';
                        submitVoiceBtn.style.display = 'inline-block';
                        stream.getTracks().forEach(track => track.stop());
                    };
                    
                    audioRecorder.start();
                    recordBtn.textContent = 'â¹ï¸';
                    recordBtn.style.background = '#dc3545';
                    recordingStatus.textContent = 'ë…¹ìŒ ì¤‘... ì¤‘ì§€í•˜ë ¤ë©´ ë‹¤ì‹œ í´ë¦­';
                    submitVoiceBtn.style.display = 'none';
                    
                } catch (error) {
                    alert('ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');
                    console.error('ë…¹ìŒ ì‹œì‘ ì‹¤íŒ¨:', error);
                }
            } else if (audioRecorder.state === 'recording') {
                audioRecorder.stop();
                recordBtn.textContent = 'ğŸ¤';
                recordBtn.style.background = '';
            }
        }
    
        async function submitVoiceAnswer() {
            if (SESSION_DATA.sessionType === 'VIDEO') {
                await submitVideoAnswer();
            } else {
                await submitAudioOnlyAnswer();
            }
        }
        
        async function submitAudioOnlyAnswer() {
            const questionId = document.getElementById('currentQuestionId').value;
            
            if (!audioBlob) {
                alert('ë¨¼ì € ìŒì„±ì„ ë…¹ìŒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!questionId) {
                alert('í˜„ì¬ ë‹µë³€í•  ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const formData = new FormData();
            formData.append('audio', audioBlob, 'answer.webm');
            formData.append('questionId', questionId);
            
            try {
                const token = getToken();
                const submitBtn = document.getElementById('submitVoiceBtn');
                submitBtn.disabled = true;
                submitBtn.textContent = 'ì œì¶œ ì¤‘...';
                
                const response = await fetch(`/api/session/${SESSION_DATA.sessionId}/voice-answer`, {
                    method: 'POST',
                    headers: {
                        'Authorization': token
                    },
                    body: formData
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    alert('ìŒì„± ë‹µë³€ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\në³€í™˜ëœ í…ìŠ¤íŠ¸: ' + result.transcription);
                    audioBlob = null;
                    audioChunks = [];
                    document.getElementById('recordingStatus').textContent = 'ë…¹ìŒ ì‹œì‘í•˜ë ¤ë©´ í´ë¦­';
                    submitBtn.style.display = 'none';
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ë‹µë³€ ì œì¶œ';
                } else {
                    alert('ìŒì„± ë‹µë³€ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ë‹µë³€ ì œì¶œ';
                }
            } catch (error) {
                console.error('ìŒì„± ë‹µë³€ ì œì¶œ ì‹¤íŒ¨:', error);
                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                const submitBtn = document.getElementById('submitVoiceBtn');
                submitBtn.disabled = false;
                submitBtn.textContent = 'ë‹µë³€ ì œì¶œ';
            }
        }

        async function submitVideoAnswer() {
            const questionId = document.getElementById('currentQuestionId').value;
            
            if (!recordedVideoBlob) {
                alert('ë¨¼ì € ë¹„ë””ì˜¤ë¥¼ ë…¹í™”í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!questionId) {
                alert('í˜„ì¬ ë‹µë³€í•  ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const formData = new FormData();
            formData.append('audio', recordedVideoBlob, 'answer.webm');
            formData.append('questionId', questionId);
            
            try {
                const token = getToken();
                const submitBtn = document.getElementById('submitVoiceBtn');
                submitBtn.disabled = true;
                submitBtn.textContent = 'ë¹„ë””ì˜¤ ë¶„ì„ ì¤‘...';
                
                const response = await fetch(`/api/session/${SESSION_DATA.sessionId}/video-answer`, {
                    method: 'POST',
                    headers: {
                        'Authorization': token
                    },
                    body: formData
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    alert('ë¹„ë””ì˜¤ ë‹µë³€ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\në³€í™˜ëœ í…ìŠ¤íŠ¸: ' + result.transcription);
                    recordedVideoBlob = null;
                    document.getElementById('videoRecordingStatus').textContent = 'ë¹„ë””ì˜¤ ë‹µë³€ ë…¹í™” ì¤€ë¹„';
                    submitBtn.style.display = 'none';
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ë‹µë³€ ì œì¶œ';
                } else {
                    alert('ë‹µë³€ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ë‹µë³€ ì œì¶œ';
                }
            } catch (error) {
                console.error('ë¹„ë””ì˜¤ ë‹µë³€ ì œì¶œ ì‹¤íŒ¨:', error);
                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                const submitBtn = document.getElementById('submitVoiceBtn');
                submitBtn.disabled = false;
                submitBtn.textContent = 'ë‹µë³€ ì œì¶œ';
            }
        }

        function displayAnswerForReview(answerData) {
            if (!SESSION_DATA.isHost) return;
            
            const answersList = document.getElementById('answers-list');
            
            const emptyState = answersList.querySelector('.empty-state');
            if (emptyState) emptyState.remove();
            
            const answerCard = document.createElement('div');
            answerCard.className = 'answer-review-card';
            answerCard.id = `answer-card-${answerData.answerId}`;
            answerCard.innerHTML = `
                <div class="answer-header">
                    <div class="user-name-badge">${answerData.userName}</div>
                    <div class="answer-time">${new Date().toLocaleTimeString()}</div>
                </div>
                <div class="question-text">Q: ${answerData.questionText}</div>
                <div class="answer-text">A: ${answerData.answerText}</div>
                
                <div class="ai-feedback-section" id="ai-feedback-${answerData.answerId}">
                    <div class="ai-feedback-loading">ğŸ¤– AI ë¶„ì„ ì¤‘...</div>
                </div>
                
                <div class="interviewer-evaluation" id="evaluation-${answerData.answerId}">
                    <div class="evaluation-header">
                        <h5>ë©´ì ‘ê´€ í‰ê°€</h5>
                    </div>
                    <div class="score-input-group">
                        <label>ì ìˆ˜ (1-10):</label>
                        <input type="number" min="1" max="10" value="7" 
                            id="score-${answerData.answerId}" class="score-input">
                    </div>
                    <div class="feedback-input-group">
                        <label>í”¼ë“œë°±:</label>
                        <textarea placeholder="ì´ ë‹µë³€ì— ëŒ€í•œ í”¼ë“œë°±ì„ ì‘ì„±í•˜ì„¸ìš”..." 
                                id="feedback-${answerData.answerId}" 
                                class="feedback-textarea"></textarea>
                    </div>
                    <button onclick="submitInterviewerFeedback(${answerData.answerId})" 
                            class="evaluation-submit-btn">í‰ê°€ ì œì¶œ</button>
                </div>
            `;
            
            answersList.appendChild(answerCard);
            updateAnswerCount();
        }

        function submitInterviewerFeedback(answerId) {
            const score = document.getElementById(`score-${answerId}`).value;
            const feedbackText = document.getElementById(`feedback-${answerId}`).value;
            
            if (!feedbackText.trim()) {
                alert('í”¼ë“œë°±ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const feedbackData = {
                answerId: answerId,
                score: parseInt(score),
                feedbackText: feedbackText,
                reviewerId: SESSION_DATA.userId
            };
            
            if (stompClient && stompClient.connected) {
                stompClient.send(`/app/session/${SESSION_DATA.sessionId}/interviewer-feedback`, 
                                {}, JSON.stringify(feedbackData));
            }
            
            const evaluationDiv = document.getElementById(`evaluation-${answerId}`);
            evaluationDiv.innerHTML = `
                <div class="submitted-evaluation">
                    âœ… í‰ê°€ ì™„ë£Œ (ì ìˆ˜: ${score}/10)
                </div>
            `;
            
            alert('í‰ê°€ê°€ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function displayAIFeedbackForInterviewer(feedbackData) {
            const aiSection = document.getElementById(`ai-feedback-${feedbackData.answerId}`);
            if (aiSection) {
                aiSection.innerHTML = `
                    <div class="ai-feedback-content">
                        <div class="ai-feedback-header">ğŸ¤– AI ë¶„ì„ ê²°ê³¼</div>
                        <div class="ai-score">ì ìˆ˜: ${feedbackData.score}/100</div>
                        <div class="ai-strengths"><strong>ê°•ì :</strong> ${feedbackData.strengths}</div>
                        <div class="ai-improvements"><strong>ê°œì„ ì :</strong> ${feedbackData.improvements}</div>
                    </div>
                `;
            }
        }

        function updateAnswerCount() {
            answerCount++;
            document.getElementById('answer-count').textContent = answerCount + 'ê°œ';
        }

        function submitAnswer() {
            const answerText = document.getElementById('answerText').value.trim();
            const questionId = document.getElementById('currentQuestionId').value;
            
            if (!answerText) {
                alert('ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            if (!questionId) {
                alert('í˜„ì¬ ë‹µë³€í•  ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const answerData = {
                questionId: questionId,
                answerText: answerText,
                userId: SESSION_DATA.userId,
                userName: SESSION_DATA.userName
            };
            
            if (stompClient && stompClient.connected) {
                stompClient.send(`/app/session/${SESSION_DATA.sessionId}/answer`, 
                                {}, JSON.stringify(answerData));
            }
            
            document.getElementById('answerText').value = '';
            document.getElementById('charCount').textContent = '0';
            alert('ë‹µë³€ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function sendQuestion() {
            const questionText = document.getElementById('newQuestionText').value.trim();
            const orderNo = parseInt(document.getElementById('newQuestionOrder').value);
            const timerSeconds = parseInt(document.getElementById('newTimerOrder').value);
            
            if (!questionText) {
                alert('ì§ˆë¬¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            const questionData = {
                text: questionText,
                orderNo: orderNo,
                timerSeconds: timerSeconds,
                sessionId: SESSION_DATA.sessionId
            };
            
            if (stompClient && stompClient.connected) {
                stompClient.send(`/app/session/${SESSION_DATA.sessionId}/question`, 
                                {}, JSON.stringify(questionData));
            }
            
            document.getElementById('newQuestionText').value = '';
            document.getElementById('newQuestionOrder').value = orderNo + 1;
            alert('ì§ˆë¬¸ì´ ì¶œì œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
    </script>
    <script th:src="@{/js/mockerview-websocket.js}"></script>
    <script th:src="@{/js/agora-client.js}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ë¡œë“œ ì™„ë£Œ');
            console.log('í˜„ì¬ sessionType:', SESSION_DATA.sessionType);
            
            startCountdown();
            
            const mediaSection = document.getElementById('mediaSection');
            console.log('mediaSection element:', mediaSection);
            
            if (SESSION_DATA.sessionType === 'AUDIO' || SESSION_DATA.sessionType === 'VIDEO') {
                console.log('ë¯¸ë””ì–´ ì„¹ì…˜ í‘œì‹œ ì‹œì‘');
                if (mediaSection) {
                    mediaSection.style.display = 'block';
                    console.log('mediaSection.style.display = block ì„¤ì •ë¨');
                }
                initializeMedia();
            } else {
                console.log('TEXT ëª¨ë“œ - ë¯¸ë””ì–´ ì„¹ì…˜ ìˆ¨ê¹€');
            }
            
            if (typeof initializeWebSocket === 'function') {
                initializeWebSocket(SESSION_DATA.sessionId, SESSION_DATA.userId, SESSION_DATA.userName);
            }
            
            if (typeof stompClient !== 'undefined') {
                stompClient.subscribe('/topic/session/' + SESSION_DATA.sessionId + '/status', function(message) {
                    const status = JSON.parse(message.body);
                    
                    if (status.status === 'ENDED') {
                        if (status.reason === 'EXPIRED') {
                            alert('â° ì„¸ì…˜ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤');
                        } else if (status.reason === 'MANUAL') {
                            alert('ğŸ›‘ í˜¸ìŠ¤íŠ¸ê°€ ì„¸ì…˜ì„ ì¢…ë£Œí–ˆìŠµë‹ˆë‹¤');
                        }
                        window.location.href = '/session/list';
                    }
                });
            }
        });
    </script>
</body>
</html>